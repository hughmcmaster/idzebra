#!/bin/sh
# $Id: idzebra-config.in,v 1.5 2005-05-03 12:31:28 adam Exp $
prefix=@prefix@
idzebra_echo_cflags=no
idzebra_echo_libs=no
idzebra_echo_help=no
idzebra_echo_tab=no
idzebra_echo_source=yes
idzebra_echo_lalibs=no
idzebra_src_root=@IDZEBRA_SRC_ROOT@
idzebra_build_root=@IDZEBRA_BUILD_ROOT@

extralibs="@YAZLIB@ @TCL_LIB@ @EXPAT_LIBS@ @XSLT_LIBS@ @LIBS@ "
extralalibs="@YAZLALIB@ @TCL_LIB@ @EXPAT_LIBS@ @XSLT_LIBS@ @LIBS@"
IDZEBRAVERSION=@VERSION@

usage()
{
    cat <<EOF
Usage: idzebra-config [OPTIONS] [LIBRARIES]
Options:
	[--prefix[=DIR]]
	[--version]
	[--libs]
	[--lalibs]
	[--cflags]
	[--tab]
EOF
    exit $1
}

if test $# -eq 0; then
    idzebra_echo_help=yes
fi

modules=""
while test $# -gt 0; do
    case "$1" in
	-*=*) optarg=`echo "$1" | sed 's/[-_a-zA-Z0-9]*=//'` ;;
	*) optarg= ;;
    esac
    
    case $1 in
	--prefix=*)
	    prefix=$optarg
	    ;;
	--prefix)
	    echo $prefix
	    exit 0
	    ;;
	--version)
	    echo $IDZEBRAVERSION
	    exit 0
	    ;;
	--cflags)
	    idzebra_echo_cflags=yes
	    ;;
	--libs)
	    idzebra_echo_libs=yes
	    ;;
	--tab)
	    idzebra_echo_tab=yes
	    ;;
	--lalibs)
	    idzebra_echo_lalibs=yes
	    ;;
	-*)
	    idzebra_echo_help=yes
	    ;;
	*)
	    modules="$modules $1"
	    ;;
    esac
    shift
done

IDZEBRALIB=""
IDZEBRALALIB=""
IDZEBRAINC="@YAZINC@"

if test -z "$modules"; then
    modules="api rset recctrl dict isams isamc isamb data1 bfile dfa util"
fi

for m in $modules; do
    d=$m
    if test "$m" = "api"; then
        d="index"
    fi
    if test "$idzebra_echo_source" = "yes"; then
	IDZEBRALIB="$IDZEBRALIB -L${idzebra_build_root}/$d/.libs -lidzebra-$m"
        IDZEBRALALIB="$IDZEBRALALIB ${idzebra_build_root}/$d/libidzebra-$m.la"
    else
	IDZEBRALIB="$IDZEBRALIB -lidzebra-$m"
    fi
done

if test "$idzebra_echo_source" = "yes"; then
    IDZEBRALIB="$IDZEBRALIB $extralibs"
    IDZEBRALALIB="$IDZEBRALALIB $extralalibs"
    IDZEBRAINC="$IDZEBRAINC -I${idzebra_src_root}/include"
    IDZEBRATAB="${idzebra_src_root}/tab"
else
    if test "$prefix" != "/usr"; then
	IDZEBRALIB="-L${prefix}/lib $IDZEBRALIB"
	IDZEBRAINC="$IDZEBRAINC -I${prefix}/include"
    fi
    IDZEBRALIB="$IDZEBRALIB $extralibs"
    IDZEBRALALIB="$IDZEBRALIB"
    IDZEBRATAB="@datadir@/idzebra/tab"
fi

if test "$idzebra_echo_help" = "yes"; then
    usage 1 1>&2
fi
if test "$idzebra_echo_cflags" = "yes"; then
    echo $IDZEBRAINC
fi
if test "$idzebra_echo_libs" = "yes"; then
    echo $IDZEBRALIB
fi
if test "$idzebra_echo_lalibs" = "yes"; then
    echo $IDZEBRALALIB
fi
if test "$idzebra_echo_tab" = "yes"; then
    echo $IDZEBRATAB
fi
