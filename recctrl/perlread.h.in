/* Perl configuration */
#include <EXTERN.h>
#include <perl.h>

#define PERL_BINARY @PERL_BINARY@
#define PERL_XS_INIT @PERL_XS_INIT@

@PERL_XS_INIT_INCLUDE@

#define GRS_PERL_MODULE_NAME_MAXLEN 255

#include <data1.h>

/* Context information for the filter */
struct perl_context {
    PerlInterpreter *perli;
    PerlInterpreter *origi;
    int perli_ready;
    char filterClass[GRS_PERL_MODULE_NAME_MAXLEN];
    SV *filterRef;
    
    int (*readf)(void *, char *, size_t);
    off_t (*seekf)(void *, off_t);
    off_t (*tellf)(void *);
    void (*endf)(void *, off_t);
    
    void *fh;
    data1_handle dh;
    NMEM mem;
    data1_node *res;
    char type[GRS_PERL_MODULE_NAME_MAXLEN];
};
